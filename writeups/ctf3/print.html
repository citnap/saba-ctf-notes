<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Uni CTF Writeup</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Uni CTF Writeup</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="write-up-for-uni-ctf"><a class="header" href="#write-up-for-uni-ctf">Write-up for Uni CTF</a></h1>
<p>This is the write-up for the CTF competition held at my exchange university.
The challenges in this CTF primarily focus on network protocols and understanding how they work, as the overall theme of the event is <strong>Networking</strong>.</p>
<p>This CTF consists of 5 challenges. Unfortunately, I got only 3 of them -_-</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="would-you-like-to-dance"><a class="header" href="#would-you-like-to-dance">Would you like to dance?</a></h1>
<p><img src="imgs/flag2.png" alt="flag-2_Description" /></p>
<hr />
<p>The first thing I tried was to scan the ports to see which ones were open for interaction.</p>
<p><img src="imgs/flag2-nmap-scan.png" alt="flag-2_ports" /></p>
<p>From the image above, the open ports are <strong>139/tcp</strong> and <strong>445/tcp</strong>, both associated with <a href="flag_2.html#note-about-the-protocols">NetBIOS-SSN</a> services. Since the version is identified as Samba <code>smbd</code>, these ports seem to be used for sharing files with printers or other devices while establishing a session with NetBIOS.</p>
<p>After asking ChatGPT what I could do to interact with this protocol next, the following command was suggested: <code>smbclient -L //10.15.2.20/ -N</code></p>
<p><code>smbclient</code> is the command used to make a client connection to the serverâ€”similar to how <code>ssh</code> is used to connect with an SSH server. The <code>-L</code> and <code>-N</code> options are used to <strong>list shared resources</strong> and to <strong>disable the password prompt</strong>, respectively.</p>
<p><strong>Funny note</strong>: <code>//ip/</code> is the UNC path style format used with the SMB protocol. This simply means: <code>//server/share</code></p>
<p><img src="imgs/flag2-step2.png" alt="smb client list" /></p>
<p>After trying to manually browse using <code>ls</code> inside these shares for a while, I discovered that the <code>enum4linux</code> command could automatically enumerate the shares on this server.</p>
<p><img src="imgs/flag2-step3-enum4linux.png" alt="smbenum" />
<img src="imgs/flag2-final.png" alt="flag" /></p>
<p>Luckily, I found the flag in the <strong>account information section</strong>, specifically in the description of one user.</p>
<hr />
<h2 id="note-to-self"><a class="header" href="#note-to-self">Note to self</a></h2>
<h3 id="protocol-knowledge"><a class="header" href="#protocol-knowledge">Protocol Knowledge</a></h3>
<ul>
<li>
<p><strong>NetBIOS (Network Basic Input/Output System)</strong>
An old protocol operating at the session layer, used for communication between computers in the same LAN. However, with the advent of TCP/IP, <strong>NetBIOS over TCP/IP</strong> allows connections beyond the local network. Note that <code>netbios-ssn</code> refers to the NetBIOS Session Service.</p>
</li>
<li>
<p><strong>SMB (Server Message Block)</strong>
An application-layer protocol used for sharing files between devices on a network.</p>
</li>
</ul>
<h3 id="commands"><a class="header" href="#commands">Commands</a></h3>
<ul>
<li><code>smbclient</code> -  ftp-like client to access SMB/CIFS resources on
servers</li>
<li><code>enum4linux</code> - tool for enumerating information from Windows and Samba systems.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="who-is-in-charge"><a class="header" href="#who-is-in-charge">Who is in charge?</a></h1>
<p><img src="imgs/flag3.png" alt="description" /></p>
<hr />
<p>I began with port scanning again.</p>
<p><img src="imgs/flag3-nmapscan.png" alt="port scan" /></p>
<p>From the output, the available service is DNS service, which we normally use to look up the IP address of domain names.</p>
<p>What I tried first is checking the domain name of the server from my DNS server.</p>
<p><img src="imgs/flag3-step2-nslookup.png" alt="nslookup" /></p>
<p>While trying different stuff like looking up the IP or the domain name of other websites, I randomly tried looking up the domain name "arsernic15.team15_ctf3" of the challenge server on its DNS service.</p>
<p><img src="imgs/flag3-step3-reverse-dnslookup.png" alt="reverse dns lookup" /></p>
<p>This seems like the domain name is set to be different from the challenge server and local server. However, this doesn't reveal anything much important.</p>
<p>Then I tried to look up more about vulnerabilities related to DNS.</p>
<p>One thing I found is DNS spoofing, but when I tried looking at the network traffic from Wireshark, it seemed like no one is communicating with the challenge servers, so I guess that it probably may not be related to DNS spoofing.</p>
<p>Fortunately, by checking the zone transfer vulnerabilities with <code>dig</code> command, the flag is found.</p>
<p><img src="imgs/flag3-final-dig.png" alt="zonetransfer" /></p>
<h2 id="note-to-self-1"><a class="header" href="#note-to-self-1">Note to Self</a></h2>
<h3 id="commands-related-to-dns"><a class="header" href="#commands-related-to-dns">Commands related to DNS</a></h3>
<ul>
<li><code>nslookup</code> â€” for basic DNS queries and domain resolution</li>
<li><code>dig</code> â€” powerful DNS querying tool, also supports zone transfer attempts with <code>AXFR</code></li>
</ul>
<h3 id="vulnerabilities-related-to-dns"><a class="header" href="#vulnerabilities-related-to-dns">Vulnerabilities related to DNS</a></h3>
<ul>
<li><code>dns spoofing</code> â€” forging DNS responses to redirect traffic to malicious IPs</li>
<li><code>zone transfer</code> â€” misconfigured DNS servers may leak full zone records using <code>dig AXFR</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="easy-to-fetch"><a class="header" href="#easy-to-fetch">Easy to Fetch</a></h1>
<p><img src="imgs/flag4.png" alt="description" /></p>
<p>At first, I began by scanning the ports like what I had done in the other challenges. However, it revealed nothing, so I scanned the top 1000 UDP ports instead.</p>
<pre><code class="language-bash">nmap -sU --top-ports 1000 &lt;ip&gt;
</code></pre>
<p><img src="imgs/flag4-nmap-UDP.png" alt="nmap-scan" /></p>
<p>From the output, the open ports are 67 and 69 â€” for <strong>DHCP</strong> and <strong>TFTP</strong>, respectively.</p>
<p>First, I tried to connect to the TFTP protocol and play around with it. Unfortunately, from the help menu of TFTP, we don't have the <code>ls</code> command. So I just tried guessing the name of the flag file.
<strong>Spoiler alert!!</strong> That didnâ€™t work ._.</p>
<p>This made me hypothesize that the file name of the flag might be given by another protocol.</p>
<p><img src="imgs/flag4-step2-tftp.png" alt="tftp-try" /></p>
<p>Next, I tried to use the DHCP service on the server by using the <code>dhcping</code> command to interact with it.</p>
<p><img src="imgs/flag4-step3-dhcping.png" alt="dhcping" />
<img src="imgs/flag4-step4-dhcping-request-withourIP.png" alt="dhcping-with-ip" /></p>
<p>From both outputs above, these are my first attempts at using <code>dhcping</code> randomly, which in fact did not work. In the first image, I specified only <code>-s</code>, which is the server IP. In the second image, I specified both the server IP and client IP with <code>-c</code>.
Actually, in the packet captures from both images, there is a section about the <strong>boot file</strong>, which reminded me of the hint in the challenge description. However, neither attempt revealed anything about the boot file, since I used the protocol incorrectly.</p>
<p>By looking at the <code>man</code> page of <code>dhcping</code>, I found that the correct usage requires specifying both the MAC address and the IP related to it. So the correct command should be:</p>
<pre><code class="language-bash">dhcping -s &lt;server_ip&gt; -c &lt;client_ip&gt; -m &lt;mac_address&gt;
</code></pre>
<p><img src="imgs/flag4-dhcping-final.png" alt="dhcp success" /></p>
<p>After adding the MAC address, the protocol successfully responded with the assigned IP <strong>together with the boot file name</strong>.
Now, I continued with my hypothesis â€” that the <strong>boot file name</strong> returned from the DHCP response is probably the name of the flag.</p>
<p>Then, I tried requesting this file from the TFTP server:</p>
<p><img src="imgs/flag4-final.png" alt="tftf flag" /></p>
<p>Luckily, this actually gave me the flag for the challenge.</p>
<hr />
<h1 id="note-to-self-2"><a class="header" href="#note-to-self-2">Note to self</a></h1>
<h2 id="funny-protocols"><a class="header" href="#funny-protocols">Funny Protocols</a></h2>
<ul>
<li>
<p><strong>DHCP</strong>: An IP configuration protocol that dynamically assigns IP addresses.</p>
<p><em>Fun fact</em>: DHCP replaced the old BOOTP protocol, meaning it also supports sending a boot file to diskless clients â€” the same boot file mentioned in the challenge description.</p>
</li>
<li>
<p><strong>TFTP</strong>: A simple file transfer protocol that uses UDP for file transfer.</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
